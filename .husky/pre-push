#!/usr/bin/env sh

# Get the current branch name
branch=$(git symbolic-ref --short HEAD)

# Check if this is a version commit (to avoid infinite loops)
commit_msg=$(git log -1 --pretty=%B)
if [[ $commit_msg == *"v0.0."* ]]; then
  echo "This appears to be a version commit, skipping version bump to avoid infinite loop"
  exit 0
fi

# Only bump version when pushing to master/main
if [ "$branch" = "master" ] || [ "$branch" = "main" ]; then
  echo "Pushing to master/main - bumping version..."
  npm run version:patch
fi
